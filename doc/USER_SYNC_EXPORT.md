# Выгрузка пользователей в Excel

## Назначение

Очередь выгрузки (`UserSyncQueue`) фиксирует все изменения пользователей (создание, обновление, удаление) для передачи в внешние сервисы. Экспорт в Excel — способ получить не выгруженные записи в виде файла для ручной или автоматической обработки.

## Когда появляются записи

- **create** — при регистрации нового пользователя
- **update** — при изменении данных пользователя (профиль, наставник, бизнес-статус и т.п.)
- **delete** — при удалении пользователя

## Как выгрузить

1. Перейти в админку → **Пользователи** → **Очереди выгрузки пользователей**
2. Нажать кнопку **«Выгрузить в Excel»**
3. Скачивается файл `user_sync_queue_YYYYMMDD_HHMM.xlsx` со всеми записями со статусом «ожидает выгрузки»
4. После успешной выгрузки эти записи помечаются как «выгружено»

## Структура Excel-файла

| Колонка            | Описание                                              |
|--------------------|-------------------------------------------------------|
| ID                 | ID записи в очереди                                   |
| Действие           | Создание / Обновление / Удаление                      |
| UUID пользователя  | UUID (GUID v4) пользователя — главный идентификатор   |
| Создано            | Дата и время появления записи в очереди               |
| UUID               | UUID пользователя (из payload)                        |
| Email              | Email                                                 |
| Имя                | Имя                                                   |
| Фамилия            | Фамилия                                               |
| Телефон            | Телефон                                               |
| Бизнес-пользователь| Да/Нет                                                |
| Наставник (UUID)   | UUID наставника (пригласившего), если есть            |
| Активен            | Да/Нет                                                |
| Дата регистрации   | ISO-дата регистрации                                  |

Для **удаления** заполнены только ID записи, действие, UUID пользователя и создано; остальные поля пустые.

## Важно

- Выгружаются только записи в статусе **ожидает выгрузки**
- Один и тот же пользователь может появиться в очереди несколько раз (создание, затем обновления)
- UUID — основной ключ для идентификации пользователя во внешних системах
