# Что нужно для интернет-магазина (ИМ)

Сводка: каталог, корзина, оплата, доставка, ЛК и остальное.

---

## 1. Каталог товаров

**Что должно быть:**
- Список товаров с карточками (фото, название, цена, кнопка «В корзину»).
- Страница товара: полное описание, галерея, выбор количества, «В корзину».
- Поиск по названию/описанию.
- Фильтры и сортировка (по цене, новизне и т.п.).

**Как размещать и группировать:**

| Уровень | Зачем | Пример |
|--------|--------|--------|
| **Категории** | Основное деление каталога (меню, фильтр). | Электроника, Одежда, Аксессуары |
| **Подкатегории** (опционально) | Уточнение внутри категории. | Электроника → Наушники, Зарядки |
| **Линейки / коллекции** | Тематическая подборка без жёсткой иерархии. Один товар может входить в несколько линеек. | «Новинки», «Хиты», «Сезон-2026» |
| **Бренды** (если нужно) | Группировка по производителю. | Отдельный фильтр «Бренд» |

**Рекомендация для старта:**
- **Категории** — одна ступень (без вложенности): название, slug, порядок вывода. Товар привязан к одной категории.
- **Линейки** — отдельная сущность «Collection» (название, slug, товары — связь многие-ко-многим). На главной/в каталоге блоки «Хиты», «Новинки» — это выборка по линейке.
- Позже при росте каталога: подкатегории (parent_id у категории), бренды (отдельная модель + фильтр).

**Итого по каталогу:** категории (плоский список), товар (название, slug, описание, цена, фото, остаток, категория, is_active). Опционально — линейки/коллекции (многие-ко-многим с товарами).

---

## 2. Корзина

**Что нужно:**
- Добавление товара в корзину (с страницы товара и из каталога).
- Страница корзины: список позиций, количество, сумма по позиции, итого.
- Изменение количества, удаление позиции.
- Переход к оформлению заказа из корзины.

**Где хранить:** сессия Django (серверная корзина) — проще для ЛК и единообразия. Вариант: localStorage + синхронизация при входе в ЛК.

---

## 3. Оплата

Пока не детализируем. Заложим в заказе поле «способ оплаты» (при получении / онлайн). Позже — интеграция одной платёжной системы (ЮKassa, Robokassa и т.п.) и смена статуса заказа при оплате.

---

## 4. Доставка через транспортные компании (ТК)

**Что нужно:**
- В заказе — выбор способа доставки: курьер ТК, пункт выдачи ТК, почта и т.д.
- Список ТК и вариантов (СДЭК, Боксберри, DPD, Деловые Линии, ПЭК и др.) — хранить в БД как справочник «Способ доставки» (название, код ТК, тип: ПВЗ/курьер).
- При оформлении заказа клиент выбирает: ТК + город/населённый пункт. Адрес пункта выдачи или адрес для курьера — вручную или через API ТК (расчёт стоимости, список ПВЗ) — это уже следующий этап.
- В заказе сохраняем: способ доставки (id или код), город, адрес/ПВЗ, стоимость доставки (если считаем сразу).

**Минимум на старт:** справочник способов доставки (название ТК, тип), в форме заказа — выбор из списка + поле «Город» и «Адрес» (текст). Расчёт стоимости и выбор ПВЗ через API ТК — позже.

---

## 5. Личный кабинет клиента (ЛК)

**Что должно быть:**
- **Регистрация / вход** — email (логин), пароль. Восстановление пароля (письмо со ссылкой).
- **Профиль:** имя, телефон, email (редактирование).
- **Адреса доставки:** несколько адресов, один можно пометить «по умолчанию». Использование при оформлении заказа.
- **История заказов:** список заказов (номер, дата, сумма, статус), по клику — состав заказа и статус доставки (если передаём в ТК и получаем трекинг — позже).
- Опционально: избранное, бонусы/баллы — после запуска базового ЛК.

**Связь с заказом:** заказ может быть от гостя (user_id пустой, контакты в полях заказа) или от авторизованного (user_id, адрес из профиля/выбранный из «Мои адреса»).

---

## 6. Что ещё нужно для ИМ

| Блок | Что нужно |
|------|-----------|
| **Админка** | **Обязательно.** Управление товарами, категориями, заказами (просмотр, смена статуса), способами доставки. Django Admin — достаточно на старт. |
| **Уведомления** | Планируем **Telegram**: уведомление клиенту после оформления заказа (состав, контакты), уведомление админу о новом заказе. Детали канала/бота — позже. |
| **Остатки** | **Контроль обязателен.** Учёт остатков по товарам: при оформлении/оплате уменьшать остаток; при нуле — не давать добавить в корзину или «под заказ». Отображение остатка в карточке товара и в админке. |
| **Статусы заказа** | **Отслеживать.** Новый → Оплачен (если онлайн) → Передан в ТК → В пути → Выполнен. Отмена. Отображение в ЛК и в админке. |
| **Поиск и SEO** | Поиск по каталогу (название, описание). Мета-теги у категорий и товаров, sitemap. |
| **Контент-страницы** | О магазине, Доставка и оплата, Контакты, Возврат — статичные или из админки. |

**Опционально позже:**
- Интеграция с ТК (расчёт стоимости, выбор ПВЗ на карте, трекинг).
- Отзывы о товарах.
- Купоны/скидки.
- Личный кабинет поставщика/партнёра — только если будет такая задача.

---

## 7. Сводка: что делаем по приоритету

1. **Каталог** — категории (плоский список), товары, линейки/коллекции (опционально). Список + карточка товара, поиск, фильтр по категории.
2. **Корзина** — сессия, страница корзины, переход к оформлению.
3. **Оформление заказа** — форма (контакты, адрес, способ доставки из справочника ТК). Сохранение Order + OrderItem. Экран «Заказ принят».
4. **Доставка** — справочник способов доставки (ТК, тип), выбор в заказе. Поля: город, адрес. Расчёт и ПВЗ через API — позже.
5. **Оплата** — поле в заказе «способ оплаты»; интеграция платёжки — позже.
6. **ЛК** — регистрация/вход, профиль, адреса, история заказов.
7. **Админка** — товары, категории, заказы, способы доставки (Django Admin).
8. **Уведомления** — письмо клиенту, уведомление админу о новом заказе.

---

## 8. Остатки и пользователи: сейчас в нашей БД, позже — отдельный сервис

**Сейчас:** остатки товаров и пользователи (ЛК) храним в нашей базе PostgreSQL (модели Product.stock, User, профиль, адреса).

**Планируем позже:** вынести в отдельный сервис:
- **Остатки** — отдельный сервис (или интеграция с учётной системой). Магазин будет запрашивать остаток/резерв по API, а не читать поле в своей БД.
- **Пользователи** — отдельный сервис аутентификации/профилей (или единый ЛК для нескольких проектов). Магазин будет проверять пользователя и получать профиль/адреса по API.

**Что заложить в коде сейчас:**
- Обращение к остаткам и к данным пользователя делать через **отдельный слой (сервисы/хелперы)**, а не «напрямую» из views в модель. Тогда позже можно подменить реализацию на вызов внешнего API без переписывания всей логики.
- Модели Product (поле `stock`) и User/профиль оставить как есть; при выносе в сервис — либо оставить кэш/синхронизацию в БД, либо убрать поля и брать данные только из API.

Если нужно, могу следующим шагом переложить это в конкретные модели Django (поля для категорий, товаров, заказов, способов доставки, пользователя и адресов) и список страниц/URL.
